@using Microsoft.AspNetCore.Identity
@using _31._01.Areas.Identity.Data

@inject SignInManager<ApplicationUser> SignInManager
@inject UserManager<ApplicationUser> UserManager
@model ArticlesIndexVM
@{
    ViewData["Title"] = "Home Page";
}

<form>
    <div>
        <h1 class="display-2">Stay curious.</h1>
        <h1 class="display-5">Discover stories, thinking, and expertise from writers on any topic.</h1>
        <br />
        @if (!SignInManager.IsSignedIn(User))
        {
            <nav>
                <div>
                    <a class="navbar-brand" asp-area="" asp-controller="Home" asp-action="OurStory"><button class="btn btn-outline-dark rounded-pill display-4 " type="button">Start Now</button></a>
                </div>
            </nav>
                
            
        }
    </div>
</form>
<br />
<br />
<form asp-action="SearchCategory">
    
    <div class="form-group">
        <label class="control-label">Do An Article Search For The Desired Category</label>
        <select asp-for="CategoryId" class="form-control" asp-items="ViewBag.CategoryId"></select>
    </div>
    <div class="form-group">
        <input type="submit" value="Search Category" class="btn btn-warning" />
    </div>
    
</form>
<br />
    <div>
        <h1 class="display-6 text-light bg-secondary text-center">Most Read Articles</h1>
    </div>
@foreach (var item in Model.Articles)
{
    <div class="card text-center">
        <div class="card-header">
                @Html.DisplayFor(modelItem => item.Name)
        </div>
        <div class="card-body">
                <h5 class="card-title text-muted ">@Html.DisplayFor(modelItem => item.ApplicationUser.FirstName) @Html.DisplayFor(modelItem => item.ApplicationUser.LastName)</h5>
                @if(item.Content.Length>150){
                    <p class="card-text">@item.Content.Substring(0,150)...</p>
                }else{
                <p class="card-text">@item.Content</p>
                }
                
                <a href="#" class="btn btn-outline-warning">Read</a>
        </div>
        
        <div class="card-footer text-muted">
                @if (!SignInManager.IsSignedIn(User)){
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-heart-fill" viewBox="0 0 16 16">
                        <path fill-rule="evenodd" d="M8 1.314C12.438-3.248 23.534 4.735 8 15-7.534 4.736 3.562-3.248 8 1.314z" />
                    </svg>
                }else{
                    <form asp-action="like" method="post">
                        <button type="button" class=" btn btn-outline-danger rounded-circle" f>
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-heart-fill" viewBox="0 0 16 16">
                                <path fill-rule="evenodd" d="M8 1.314C12.438-3.248 23.534 4.735 8 15-7.534 4.736 3.562-3.248 8 1.314z" />
                            </svg>
                        </button>
                    </form>
                    
                }
            @Html.DisplayFor(modelItem => item.Popular)
        </div>
    </div>
    <br />
    <br />
}
